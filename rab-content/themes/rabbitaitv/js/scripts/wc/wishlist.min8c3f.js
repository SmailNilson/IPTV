(c=>{rabbitaitvThemeModule.$document.on("wdShopPageInit wdArrowsLoadProducts wdLoadMoreLoadProducts wdProductsTabsLoaded wdSearchFullScreenContentLoaded wdBackHistory wdRecentlyViewedProductLoaded",function(){rabbitaitvThemeModule.updateWishlistButtonState()}),rabbitaitvThemeModule.wishlist=function(){var d="rabbitaitv_wishlist_count",i="rabbitaitv_wishlist_products";if(rabbitaitv_settings.is_multisite&&(d+="_"+rabbitaitv_settings.current_blog_id,i+="_"+rabbitaitv_settings.current_blog_id),"undefined"!=typeof Cookies){var t=Cookies.get(d),e=0;if(void 0!==t)try{e=JSON.parse(t)}catch(t){console.log("cant parse cookies json")}void 0!==rabbitaitv_settings.wishlist_expanded&&"yes"===rabbitaitv_settings.wishlist_expanded||n(e),rabbitaitvThemeModule.$body.on("click",".wd-wishlist-btn a",function(t){var e=c(this);if(e.hasClass("added"))return!0;t.preventDefault();var o,t=e.data("product-id"),s=e.data("key");rabbitaitvThemeModule.$body.hasClass("logged-in")||"undefined"==typeof Cookies?(e.addClass("loading"),void 0!==rabbitaitv_settings.wishlist_expanded&&"yes"===rabbitaitv_settings.wishlist_expanded&&"disable"!==rabbitaitv_settings.wishlist_show_popup&&rabbitaitvThemeModule.$body.hasClass("logged-in")?rabbitaitvThemeModule.$document.trigger("wdShowWishlistGroupPopup",[t,s]):a(t,"",s)):(s={},(s=void 0!==(o=Cookies.get(i))&&o&&(o=JSON.parse(o),Object.keys(o).length)?o:s)[t]={product_id:t},n(o=Object.keys(s).length),Cookies.set(i,JSON.stringify(s),{expires:7,path:rabbitaitv_settings.cookie_path,secure:rabbitaitv_settings.cookie_secure_param}),Cookies.set(d,o,{expires:7,path:rabbitaitv_settings.cookie_path,secure:rabbitaitv_settings.cookie_secure_param}),l(e))}),rabbitaitvThemeModule.$body.on("click",".wd-wishlist-remove",function(t){t.preventDefault();var e,o=c(this),t="";o.parents(".wd-wishlist-group").length&&(t=o.parents(".wd-wishlist-group").data("group-id")),o.addClass("loading"),rabbitaitvThemeModule.$body.hasClass("logged-in")||"undefined"==typeof Cookies||1===o.parents(".wd-products").find(".wd-product").length?r(o.data("product-id"),t,o.parents(".wd-products"),function(){o.removeClass("loading")}):(o.parents(".wd-product").remove(),t={},void 0!==(e=Cookies.get(i))&&e&&(t=JSON.parse(e),Object.keys(t).length)&&delete t[o.data("product-id")],n(e=Object.keys(t).length),Cookies.set(i,JSON.stringify(t),{expires:7,path:rabbitaitv_settings.cookie_path,secure:rabbitaitv_settings.cookie_secure_param}),Cookies.set(d,e,{expires:7,path:rabbitaitv_settings.cookie_path,secure:rabbitaitv_settings.cookie_secure_param}))}),rabbitaitvThemeModule.$body.on("click",".wd-wishlist-checkbox",function(t){var e=c(this),o=e.parents(".wd-product"),e=e.parents(".wd-products-element").siblings(".wd-wishlist-bulk-action"),s=e.find(".wd-wishlist-select-all");o.toggleClass("wd-current-product"),s.hasClass("wd-selected")&&e.hasClass("wd-visible")&&!o.hasClass("wd-current-product")&&s.removeClass("wd-selected"),o.siblings(".product").length===o.siblings(".wd-current-product").length&&o.hasClass("wd-current-product")&&s.addClass("wd-selected"),o.siblings(".wd-current-product").length||!e.hasClass("wd-visible")||o.hasClass("wd-current-product")?e.addClass("wd-visible"):e.removeClass("wd-visible")}),rabbitaitvThemeModule.$body.on("click",".wd-wishlist-remove-action > a",function(t){t.preventDefault();var e=c(this),t=e.parents(".wd-wishlist-bulk-action").siblings(".wd-products-element").find(".products"),o=t.find(".wd-current-product"),s=[],d="";o.length&&confirm(rabbitaitv_settings.wishlist_remove_notice)&&(e.addClass("loading"),e.parents(".wd-wishlist-group").length&&(d=e.parents(".wd-wishlist-group").data("group-id")),o.each(function(){s.push(c(this).data("id"))}),r(s,d,t,function(){e.parents(".wd-wishlist-bulk-action").removeClass("wd-visible"),e.removeClass("loading")}))}),rabbitaitvThemeModule.$body.on("click",".wd-wishlist-select-all > a",function(t){t.preventDefault();var t=c(this).parent(),e=t.parents(".wd-wishlist-bulk-action").siblings(".wd-products-element").find(".products");t.hasClass("wd-selected")?(e.find(".product").removeClass("wd-current-product").find(".wd-wishlist-checkbox").prop("checked",!1),t.removeClass("wd-selected"),t.parents(".wd-wishlist-bulk-action").removeClass("wd-visible")):(e.find(".product").addClass("wd-current-product").find(".wd-wishlist-checkbox").prop("checked",!0),t.addClass("wd-selected"))}),rabbitaitvThemeModule.$document.on("wdAddProductToWishlist",function(t,e,o,s,d){a(e,o,s,d)}),rabbitaitvThemeModule.$document.on("wdRemoveProductToWishlist",function(t,e,o,s,d){r(e,o,s,d)}),rabbitaitvThemeModule.$document.on("wdUpdateWishlistContent",function(t,e){var o;e=e,o=c(".wd-wishlist-content"),n(e.count),0<o.length&&!o.hasClass("wd-wishlist-preview")&&rabbitaitvThemeModule.removeDuplicatedStylesFromHTML(e.wishlist_content,function(t){o.replaceWith(t),rabbitaitvThemeModule.$document.trigger("wdUpdateWishlist")})})}function n(t){var e=c(".wd-header-wishlist");0<e.length&&e.find(".wd-tools-count").text(t)}function a(t,e,o,s=""){var d=c("a[data-product-id="+t+"]");c.ajax({url:rabbitaitv_settings.ajaxurl,data:{action:"rabbitaitv_add_to_wishlist",product_id:t,group:e,key:o},dataType:"json",method:"GET",success:function(t){t?(t.count&&n(t.count),t.fragments&&(rabbitaitvThemeModule.$document.trigger("wdWishlistSaveFragments",[t.fragments,t.hash]),c.each(t.fragments,function(e,t){rabbitaitvThemeModule.removeDuplicatedStylesFromHTML(t,function(t){c(e).replaceWith(t)})})),l(d)):console.log("something wrong loading wishlist data ",t),s&&s()},error:function(){console.log("We cant add to wishlist. Something wrong with AJAX response. Probably some PHP conflict.")},complete:function(){d.removeClass("loading")}})}function r(t,e,i,a=""){var o="";void 0!==i.data("atts")&&((o=i.data("atts")).ajax_page=i.attr("data-paged")),c.ajax({url:rabbitaitv_settings.ajaxurl,data:{action:"rabbitaitv_remove_from_wishlist",product_id:t,group_id:e,key:rabbitaitv_settings.wishlist_page_nonce,atts:o},dataType:"json",method:"GET",success:function(t){var e,o,s,d;t.wishlist_content?(o=(e=i.parents(".wd-products-element")).parents(".wd-wishlist-content"),n(t.count),s=t,(d=e).length&&!c(".wd-wishlist-content").hasClass("wd-wishlist-preview")&&rabbitaitvThemeModule.removeDuplicatedStylesFromHTML(s.wishlist_content,function(t){d.replaceWith(t),rabbitaitvThemeModule.$document.trigger("wdUpdateWishlist")}),setTimeout(function(){var t=c(".wd-wishlist-content .wd-pagination").find("a.page-numbers");t.length&&t.each(function(){var t=c(this),e=t.attr("href").split("product-page=")[1],e=parseInt(e);t.attr("href",window.location.origin+window.location.pathname+"?product-page="+e)})},500),t.hasOwnProperty("count")&&0===t.count&&o.find(".wd-wishlist-head, .wd-wishlist-bulk-action").remove()):console.log("something wrong loading wishlist data ",t),t.fragments&&rabbitaitvThemeModule.$document.trigger("wdUpdateWishlistFragments",[t.fragments,t.hash]),a&&a()},error:function(){console.log("We cant remove from wishlist. Something wrong with AJAX response. Probably some PHP conflict.")}})}function l(t){var e=t.data("added-text");(0<t.find("span").length?t.find("span"):t).text(e),t.addClass("added"),rabbitaitvThemeModule.$document.trigger("added_to_wishlist")}},rabbitaitvThemeModule.updateWishlistButtonState=function(){var t,e;void 0===rabbitaitv_settings.wishlist_save_button_state||"yes"!==rabbitaitv_settings.wishlist_save_button_state||"undefined"==typeof Cookies||rabbitaitvThemeModule.$body.hasClass("logged-in")||(e="rabbitaitv_wishlist_products",t={},rabbitaitv_settings.is_multisite&&(e+="_"+rabbitaitv_settings.current_blog_id),(t=void 0!==(e=Cookies.get(e))&&e?Object.values(JSON.parse(e)):t).length&&c.each(t,function(t,e){var o,e=c(".wd-wishlist-btn a[data-product-id="+e.product_id+"]");e.length&&!e.hasClass("added")&&(e.addClass("added"),o=e.data("added-text"),(0<e.find("span").length?e.find("span"):e).text(o))}))},c(document).ready(function(){rabbitaitvThemeModule.wishlist(),rabbitaitvThemeModule.updateWishlistButtonState()})})(jQuery);